<!DOCTYPE html>

<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã“ã“ã‚ã®ã‚­ãƒ£ãƒ³ãƒã‚¹è¨ºæ–­ - å¿ƒç†ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', 'Yu Gothic UI', sans-serif;
        background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 25%, #fecfef 75%, #ffc3a0 100%);
        background-size: 400% 400%;
        animation: gradientFlow 15s ease infinite;
        min-height: 100vh;
        color: #2d3748;
        overflow-x: hidden;
    }

    @keyframes gradientFlow {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    .sparkle {
        position: absolute;
        width: 6px;
        height: 6px;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 50%;
        animation: sparkle 3s infinite;
        pointer-events: none;
    }

    @keyframes sparkle {
        0%, 100% { opacity: 0; transform: scale(0) rotate(0deg); }
        50% { opacity: 1; transform: scale(1) rotate(180deg); }
    }

    .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    /* Progress Bar */
    .progress-section {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(15px);
        padding: 1rem 2rem;
        z-index: 100;
        box-shadow: 0 4px 25px rgba(0, 0, 0, 0.08);
        display: none;
    }

    .progress-bar {
        width: 100%;
        height: 6px;
        background: rgba(255, 154, 158, 0.2);
        border-radius: 20px;
        overflow: hidden;
        margin-bottom: 0.5rem;
    }

    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #ff9a9e, #fecfef, #ffc3a0);
        border-radius: 20px;
        transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        width: 0%;
    }

    .progress-text {
        font-size: 0.9rem;
        color: #6b7280;
        text-align: center;
        font-weight: 500;
    }

    /* Main Glass Card */
    .glass-card {
        background: rgba(255, 255, 255, 0.85);
        border-radius: 30px;
        padding: 3rem;
        backdrop-filter: blur(20px);
        box-shadow: 
            0 25px 50px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.3);
        margin-top: 20px;
        transform: translateY(20px);
        opacity: 0;
        animation: slideInUp 0.8s ease-out forwards;
    }

    .step-badge {
        display: inline-block;
        padding: 0.6rem 1.5rem;
        background: linear-gradient(135deg, #ff9a9e, #fecfef);
        color: white;
        border-radius: 25px;
        font-size: 0.85rem;
        font-weight: 600;
        margin-bottom: 2rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 0 8px 20px rgba(255, 154, 158, 0.3);
    }

    .title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        background: linear-gradient(135deg, #2d3748, #4a5568);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        line-height: 1.2;
    }

    .subtitle {
        font-size: 1.1rem;
        color: #6b7280;
        margin-bottom: 2.5rem;
        line-height: 1.6;
    }

    /* Profile Form */
    .form-group {
        margin-bottom: 1.8rem;
    }

    .form-label {
        display: block;
        margin-bottom: 0.8rem;
        font-weight: 600;
        color: #374151;
        font-size: 1rem;
    }

    .glass-input {
        width: 100%;
        padding: 1.2rem 1.8rem;
        border: 2px solid rgba(255, 154, 158, 0.3);
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(10px);
        font-size: 1rem;
        color: #374151;
        transition: all 0.3s ease;
        box-shadow: 
            0 4px 15px rgba(0, 0, 0, 0.05),
            inset 0 1px 0 rgba(255, 255, 255, 0.6);
    }

    .glass-input:focus {
        outline: none;
        border-color: #ff9a9e;
        background: rgba(255, 255, 255, 0.9);
        box-shadow: 
            0 8px 25px rgba(255, 154, 158, 0.2),
            0 0 0 3px rgba(255, 154, 158, 0.1);
        transform: translateY(-2px);
    }

    .glass-input::placeholder {
        color: #9ca3af;
    }

    /* Department Grid */
    .department-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1.2rem;
        margin-top: 1rem;
    }

    .dept-card {
        padding: 1.8rem;
        border: 2px solid rgba(255, 154, 158, 0.25);
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(10px);
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    .dept-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
        transition: left 0.6s ease;
    }

    .dept-card:hover {
        border-color: rgba(255, 154, 158, 0.5);
        background: rgba(255, 255, 255, 0.8);
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 15px 35px rgba(255, 154, 158, 0.25);
    }

    .dept-card:hover::before {
        left: 100%;
    }

    .dept-card.selected {
        border-color: #ff9a9e;
        background: rgba(255, 154, 158, 0.15);
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 15px 35px rgba(255, 154, 158, 0.3);
    }

    .dept-icon {
        font-size: 2.2rem;
        margin-bottom: 0.8rem;
        display: block;
    }

    .dept-title {
        font-weight: 600;
        color: #2d3748;
        margin-bottom: 0.4rem;
        font-size: 1.1rem;
    }

    .dept-desc {
        font-size: 0.9rem;
        color: #6b7280;
        line-height: 1.4;
    }

    /* Question Section */
    .question-section {
        display: none;
    }

    .question-section.active {
        display: block;
        animation: slideInUp 0.6s ease-out;
    }

    .question-title {
        font-size: 1.6rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: #2d3748;
        line-height: 1.4;
    }

    .question-subtitle {
        font-size: 1rem;
        color: #6b7280;
        margin-bottom: 2.5rem;
        line-height: 1.6;
    }

    /* Glass Slider */
    .slider-container {
        margin: 3rem 0;
        padding: 2rem;
        background: rgba(255, 255, 255, 0.4);
        border-radius: 20px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .slider-labels {
        display: flex;
        justify-content: space-between;
        margin-bottom: 1.5rem;
        font-size: 0.9rem;
        color: #6b7280;
        font-weight: 500;
    }

    .slider-track {
        position: relative;
        height: 12px;
        background: linear-gradient(90deg, 
            rgba(220, 38, 127, 0.2) 0%,
            rgba(255, 154, 158, 0.3) 50%,
            rgba(34, 197, 94, 0.4) 100%);
        border-radius: 20px;
        margin: 2rem 0;
        cursor: pointer;
        box-shadow: 
            inset 0 2px 4px rgba(0, 0, 0, 0.1),
            0 1px 0 rgba(255, 255, 255, 0.6);
    }

    .slider-thumb {
        position: absolute;
        top: 50%;
        width: 28px;
        height: 28px;
        background: linear-gradient(135deg, #ffffff, #f8fafc);
        border: 3px solid #ff9a9e;
        border-radius: 50%;
        transform: translate(-50%, -50%);
        cursor: grab;
        transition: all 0.3s ease;
        box-shadow: 
            0 4px 15px rgba(255, 154, 158, 0.4),
            inset 0 1px 0 rgba(255, 255, 255, 0.8);
        z-index: 2;
    }

    .slider-thumb:hover {
        transform: translate(-50%, -50%) scale(1.2);
        box-shadow: 
            0 8px 25px rgba(255, 154, 158, 0.5),
            inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }

    .slider-thumb:active {
        cursor: grabbing;
        transform: translate(-50%, -50%) scale(1.1);
    }

    .slider-value {
        text-align: center;
        margin-top: 1rem;
        font-size: 1.1rem;
        font-weight: 600;
        color: #374151;
    }

    .value-indicators {
        display: flex;
        justify-content: space-between;
        margin-top: 0.5rem;
        font-size: 0.8rem;
        color: #9ca3af;
    }

    /* Free Text Area */
    .glass-textarea {
        width: 100%;
        min-height: 180px;
        padding: 1.5rem;
        border: 2px solid rgba(255, 154, 158, 0.3);
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(10px);
        font-size: 1rem;
        font-family: inherit;
        color: #374151;
        resize: vertical;
        transition: all 0.3s ease;
        margin-bottom: 2rem;
        box-shadow: 
            0 4px 15px rgba(0, 0, 0, 0.05),
            inset 0 1px 0 rgba(255, 255, 255, 0.6);
    }

    .glass-textarea:focus {
        outline: none;
        border-color: #ff9a9e;
        background: rgba(255, 255, 255, 0.9);
        box-shadow: 
            0 8px 25px rgba(255, 154, 158, 0.2),
            0 0 0 3px rgba(255, 154, 158, 0.1);
    }

    .glass-textarea::placeholder {
        color: #9ca3af;
        font-style: italic;
    }

    /* Navigation Buttons */
    .nav-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 3rem;
        gap: 1rem;
    }

    .glass-button {
        padding: 1.2rem 2.5rem;
        border: none;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        font-size: 1rem;
        position: relative;
        overflow: hidden;
        backdrop-filter: blur(10px);
    }

    .glass-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
        transition: left 0.6s ease;
    }

    .glass-button:hover::before {
        left: 100%;
    }

    .btn-back {
        background: rgba(255, 255, 255, 0.6);
        color: #6b7280;
        border: 2px solid rgba(255, 154, 158, 0.3);
    }

    .btn-back:hover {
        background: rgba(255, 255, 255, 0.8);
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    .btn-next {
        background: linear-gradient(135deg, #ff9a9e, #fecfef);
        color: white;
        border: 2px solid transparent;
        box-shadow: 0 8px 25px rgba(255, 154, 158, 0.4);
    }

    .btn-next:hover {
        transform: translateY(-4px) scale(1.02);
        box-shadow: 0 12px 35px rgba(255, 154, 158, 0.5);
    }

    .btn-next:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
    }

    /* Hidden sections */
    .hidden {
        display: none;
    }

    /* Animations */
    @keyframes slideInUp {
        from {
            transform: translateY(30px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    /* Loading State */
    .loading-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        z-index: 1000;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        backdrop-filter: blur(5px);
    }

    .loading-spinner {
        width: 80px;
        height: 80px;
        border: 4px solid rgba(255, 255, 255, 0.3);
        border-top: 4px solid #ff9a9e;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 1.5rem;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .loading-text {
        color: white;
        font-size: 1.2rem;
        text-align: center;
        line-height: 1.6;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .container {
            padding: 1rem;
        }

        .glass-card {
            padding: 2rem 1.5rem;
            margin-top: 80px;
        }

        .title {
            font-size: 2rem;
        }

        .department-grid {
            grid-template-columns: 1fr;
        }

        .nav-buttons {
            flex-direction: column;
        }

        .glass-button {
            width: 100%;
        }

        .slider-thumb {
            width: 32px;
            height: 32px;
        }
    }
</style>
```

</head>
<body>
    <!-- Progress Bar -->
    <div class="progress-section" id="progressSection">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">è³ªå• 1 / 20</div>
    </div>

```
<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <div class="loading-text">
        ã‚ãªãŸã®å¿ƒã‚’åˆ†æã—ã¦ã„ã¾ã™...<br>
        å°‘ã€…ãŠå¾…ã¡ãã ã•ã„ âœ¨
    </div>
</div>

<div class="container">
    <!-- Welcome & Profile Section -->
    <div class="glass-card" id="welcomeSection">
        <div class="step-badge">å¿ƒç†ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆ</div>
        <h1 class="title">ã“ã“ã‚ã®ã‚­ãƒ£ãƒ³ãƒã‚¹è¨ºæ–­</h1>
        <p class="subtitle">ã‚ãªãŸã®å¿ƒã®çŠ¶æ…‹ã‚’å„ªã—ãç†è§£ã—ã€ã‚ˆã‚Šè‰¯ã„æ¯æ—¥ã®ãŸã‚ã®ãƒ’ãƒ³ãƒˆã‚’ãŠå±Šã‘ã™ã‚‹å¿ƒç†ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆã§ã™ã€‚ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã¦ãŠç­”ãˆãã ã•ã„ã€‚</p>
        
        <div class="profile-section">
            <div class="form-group">
                <label class="form-label" for="userName">ãŠåå‰</label>
                <input type="text" id="userName" class="glass-input" placeholder="ãŠåå‰ã‚’ãŠèã‹ã›ãã ã•ã„" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="userAge">å¹´é½¢</label>
                <input type="number" id="userAge" class="glass-input" placeholder="å¹´é½¢ã‚’ãŠèã‹ã›ãã ã•ã„" min="18" max="100" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">ãŠä»•äº‹ãƒ»æ‰€å±</label>
                <div class="department-grid">
                    <div class="dept-card" data-department="creative">
                        <div class="dept-icon">ğŸ¨</div>
                        <div class="dept-title">ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–</div>
                        <div class="dept-desc">ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»ä¼ç”»ãƒ»åˆ¶ä½œ</div>
                    </div>
                    <div class="dept-card" data-department="tech">
                        <div class="dept-icon">ğŸ’»</div>
                        <div class="dept-title">æŠ€è¡“ãƒ»IT</div>
                        <div class="dept-desc">é–‹ç™ºãƒ»ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒ»IT</div>
                    </div>
                    <div class="dept-card" data-department="sales">
                        <div class="dept-icon">ğŸ“ˆ</div>
                        <div class="dept-title">å–¶æ¥­ãƒ»æ¥å®¢</div>
                        <div class="dept-desc">å–¶æ¥­ãƒ»è²©å£²ãƒ»ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ</div>
                    </div>
                    <div class="dept-card" data-department="manager">
                        <div class="dept-icon">ğŸ‘¥</div>
                        <div class="dept-title">ç®¡ç†ãƒ»ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ</div>
                        <div class="dept-desc">ç®¡ç†è·ãƒ»ãƒªãƒ¼ãƒ€ãƒ¼ãƒ»çµŒå–¶</div>
                    </div>
                    <div class="dept-card" data-department="general">
                        <div class="dept-icon">ğŸ“‹</div>
                        <div class="dept-title">äº‹å‹™ãƒ»ä¸€èˆ¬è·</div>
                        <div class="dept-desc">äº‹å‹™ãƒ»çµŒç†ãƒ»ç·å‹™</div>
                    </div>
                    <div class="dept-card" data-department="parttime">
                        <div class="dept-icon">â°</div>
                        <div class="dept-title">ãƒ‘ãƒ¼ãƒˆãƒ»ã‚¢ãƒ«ãƒã‚¤ãƒˆ</div>
                        <div class="dept-desc">ãƒ‘ãƒ¼ãƒˆãƒ»å¥‘ç´„ãƒ»ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹</div>
                    </div>
                    <div class="dept-card" data-department="support">
                        <div class="dept-icon">ğŸ¤</div>
                        <div class="dept-title">ã‚µãƒãƒ¼ãƒˆãƒ»ã‚±ã‚¢</div>
                        <div class="dept-desc">ä»‹è­·ãƒ»åŒ»ç™‚ãƒ»æ•™è‚²ãƒ»æ”¯æ´</div>
                    </div>
                    <div class="dept-card" data-department="student">
                        <div class="dept-icon">ğŸ“š</div>
                        <div class="dept-title">å­¦ç”Ÿ</div>
                        <div class="dept-desc">å¤§å­¦ç”Ÿãƒ»å°‚é–€å­¦ç”Ÿãƒ»é™¢ç”Ÿ</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="nav-buttons">
            <div></div>
            <button class="glass-button btn-next" id="startAssessment" disabled>è¨ºæ–­ã‚’å§‹ã‚ã‚‹ â†’</button>
        </div>
    </div>

    <!-- Question Section -->
    <div class="glass-card question-section" id="questionSection">
        <div class="step-badge" id="questionStep">è³ªå• 1 / 20</div>
        <h2 class="question-title" id="questionTitle"></h2>
        <p class="question-subtitle" id="questionSubtitle"></p>
        
        <!-- Slider Question -->
        <div class="slider-container" id="sliderContainer">
            <div class="slider-labels">
                <span>ãã†æ€ã‚ãªã„</span>
                <span>ãã†æ€ã†</span>
            </div>
            <div class="slider-track" id="sliderTrack">
                <div class="slider-thumb" id="sliderThumb"></div>
            </div>
            <div class="slider-value" id="sliderValue">3</div>
            <div class="value-indicators">
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
            </div>
        </div>
        
        <!-- Free Text Questions -->
        <textarea class="glass-textarea hidden" id="freeTextArea" placeholder="ãŠæ°—æŒã¡ã‚’è‡ªç”±ã«ãŠèã‹ã›ãã ã•ã„..."></textarea>
        
        <div class="nav-buttons">
            <button class="glass-button btn-back" id="prevButton" onclick="previousQuestion()">â† å‰ã¸</button>
            <button class="glass-button btn-next" id="nextButton" onclick="nextQuestion()" disabled>æ¬¡ã¸ â†’</button>
        </div>
    </div>
</div>

<script>
    // Japanese Department Questions
    const departmentQuestions = {
        creative: [
            "æœ€è¿‘ã€ãŠä»•äº‹ã§å‰µä½œã™ã‚‹å–œã³ã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ã‚ãªãŸã®ã‚¢ã‚¤ãƒ‡ã‚¢ãŒå‘¨ã‚Šã®æ–¹ã«è©•ä¾¡ã•ã‚Œã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å–ã‚Šçµ„ã‚€ã¨ãã€ãƒ¯ã‚¯ãƒ¯ã‚¯ã—ã¾ã™ã‹ï¼Ÿ",
            "è¡Œãè©°ã¾ã‚Šã‚’æ„Ÿã˜ã‚‹ã“ã¨ã¯ã‚ˆãã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "ãŠä»•äº‹ã§è‡ªç”±ã«è¡¨ç¾ã§ãã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ä»Šã®ç›®æ¨™ãŒã¯ã£ãã‚Šã—ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "æœ€è¿‘ã®ä½œå“ã«æº€è¶³ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "å‘¨ã‚Šã‹ã‚‰ã®æ„è¦‹ã‚„ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ã‚‚ã‚‰ãˆã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ãƒãƒ¼ãƒ ã®æ–¹å‘æ€§ã«å…±æ„Ÿã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ãŠä»•äº‹ã«ã‚„ã‚ŠãŒã„ã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ"
        ],
        tech: [
            "ä»Šã®ã‚¹ã‚­ãƒ«ã«è‡ªä¿¡ã‚’æŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ãŠä»•äº‹ã®å½¹å‰²ãŒã¯ã£ãã‚Šã—ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "æŠ€è¡“çš„ãªãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’æ¥½ã—ã‚ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "é›£ã—ã„å•é¡Œã‚’è§£æ±ºã§ããŸã¨ãã€é”æˆæ„Ÿã‚’æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ã‚ãªãŸã®è²¢çŒ®ãŒèªã‚ã‚‰ã‚Œã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ä»Šã®ä»•äº‹é‡ã¯é©åˆ‡ã ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã‚„ç’°å¢ƒãŒæ•´ã£ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ãŠç–²ã‚Œã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—ã®ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ãŠä»•äº‹ãŒå°†æ¥ã®ç›®æ¨™ã«ç¹‹ãŒã£ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ"
        ],
        sales: [
            "ãŠå®¢æ§˜ã¨ã®ã‚„ã‚Šã¨ã‚Šã«æº€è¶³ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ä¸Šå¸ã‚„ç®¡ç†è€…ã«ç†è§£ã—ã¦ã‚‚ã‚‰ãˆã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ç›®æ¨™ã‚„æœŸå¾…å€¤ãŒã¯ã£ãã‚Šã—ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "ãŠä»•äº‹ã®å¾Œã€ç²¾ç¥çš„ã«ãŠç–²ã‚Œã‚’æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ãŠå®¢æ§˜ã‹ã‚‰ä¿¡é ¼ã•ã‚Œã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ãŠå®¢æ§˜ã®èª²é¡Œã‚’è§£æ±ºã§ãã‚‹è‡ªä¿¡ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "ãŠä»•äº‹ã®ä¾¡å€¤ã‚’æ„Ÿã˜ã‚‰ã‚Œãªã„æ™‚ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "æ—¥ã€…ã®æ¥­å‹™é‡ã¯é©åˆ‡ã ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "åŒåƒšã‹ã‚‰ã®ã‚µãƒãƒ¼ãƒˆã‚’æ„Ÿã˜ã‚‰ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ã“ã®è·ç¨®ã§ã®å°†æ¥ã«å¸Œæœ›ã‚’æŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ"
        ],
        manager: [
            "ãƒªãƒ¼ãƒ€ãƒ¼ã¨ã—ã¦ã®åˆ¤æ–­ã«è‡ªä¿¡ã‚’æŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã®æ°—æŒã¡ã‚’ç†è§£ã§ãã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "ä¸Šå±¤éƒ¨ã¨ã®é€£æºãŒã†ã¾ãã„ã£ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ãƒãƒ¼ãƒ å†…ã®å•é¡Œã«å¯¾å‡¦ã§ãã‚‹è‡ªä¿¡ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "éƒ¨ä¸‹ã‚„ãƒ¡ãƒ³ãƒãƒ¼ã‹ã‚‰ã®ä¿¡é ¼ã‚’æ„Ÿã˜ã‚‰ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "è‡ªåˆ†ã®ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã«ã¤ã„ã¦æŒ¯ã‚Šè¿”ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "è²¬ä»»ã«ã‚ˆã‚‹ã‚¹ãƒˆãƒ¬ã‚¹ã¯ç®¡ç†ã§ãã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "çŠ¶æ³ã«å¿œã˜ã¦ã‚„ã‚Šæ–¹ã‚’å¤‰ãˆã‚‹ã“ã¨ãŒã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ãƒãƒ¼ãƒ ã¨ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã†ã¾ãã„ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ã‚ãªãŸã®ãƒ“ã‚¸ãƒ§ãƒ³ãŒãƒãƒ¼ãƒ ã«ä¼ã‚ã£ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ"
        ],
        general: [
            "æ¯æ—¥ã®æ¥­å‹™ã«ã‚„ã‚ŠãŒã„ã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ãŠä»•äº‹ã«æ„å‘³ã‚’æ„Ÿã˜ã‚‰ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "è·å ´ã§ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "ä¸Šå¸ã‹ã‚‰ã®ã‚µãƒãƒ¼ãƒˆã‚’æ„Ÿã˜ã‚‰ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ãŠä»•äº‹ã®æœŸå¾…å€¤ãŒã¯ã£ãã‚Šã—ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "æˆé•·ã®æ©Ÿä¼šãŒã‚ã‚‹ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "è·å ´ã§å­¤ç‹¬ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "ä»Šã®æ¥­å‹™é‡ã¯é©åˆ‡ã ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "ä¼šè­°ã‚„æ‰“ã¡åˆã‚ã›ã§æ„è¦‹ã‚’è¨€ã„ã‚„ã™ã„ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ä»•äº‹ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã®ãƒãƒ©ãƒ³ã‚¹ã«å¸Œæœ›ã‚’æŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ"
        ],
        parttime: [
            "è·å ´ã§å¹³ç­‰ã«æ‰±ã‚ã‚Œã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ãŠä»•äº‹ã®å®‰å®šæ€§ã«å®‰å¿ƒæ„Ÿã‚’æŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "æ¯æ—¥ã®å½¹å‰²ãŒã¯ã£ãã‚Šã—ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "æ­£ç¤¾å“¡ã®æ–¹ã‹ã‚‰ã‚‚å¤§åˆ‡ã«ã•ã‚Œã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "ãƒãƒ¼ãƒ ã®æƒ…å ±å…±æœ‰ã‹ã‚‰é™¤å¤–ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "ã‚·ãƒ•ãƒˆã‚„å‹¤å‹™æ™‚é–“ã¯èª¿æ•´ã—ã‚„ã™ã„ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "å›°ã£ãŸã¨ãã«ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "å°†æ¥ã¸ã®ä¸å®‰ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "ãŠä»•äº‹ã®æŸ”è»Ÿæ€§ã«æº€è¶³ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "è·å ´ã‚„ãƒãƒ¼ãƒ ã¨ã®ç¹‹ãŒã‚Šã‚’æ„Ÿã˜ã‚‰ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ"
        ],
        support: [
            "ãŠä»•äº‹ã«ã‚„ã‚ŠãŒã„ã¨å……å®Ÿæ„Ÿã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ã‚ãªãŸã®åŠªåŠ›ãŒèªã‚ã‚‰ã‚Œã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "æ„Ÿæƒ…çš„ãªè² æ‹…ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "å›°é›£ãªçŠ¶æ³ã§ãƒãƒ¼ãƒ ã‹ã‚‰ã®ã‚µãƒãƒ¼ãƒˆã‚’æ„Ÿã˜ã‚‰ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ç›¸æ‰‹ã®æ–¹ã¨ã®é©åˆ‡ãªè·é›¢ã‚’ä¿ã¦ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "å…±æ„Ÿã—ã™ããšã«è‡ªåˆ†ã‚’å®ˆã‚‹ã“ã¨ãŒã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "è¤‡é›‘ãªçŠ¶æ³ã«å¯¾å‡¦ã™ã‚‹æº–å‚™ãŒã§ãã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
            "è·å ´ç’°å¢ƒã¯å®‰å…¨ã ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "å¤§å¤‰ãªä¸€æ—¥ã®å¾Œã€å¿ƒã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹æ™‚é–“ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "ã‚ãªãŸã®ãŠä»•äº‹ãŒç¤¾ä¼šã«è‰¯ã„å½±éŸ¿ã‚’ä¸ãˆã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ"
        ],
        student: [
            "æœ€è¿‘ã®å­¦æ¥­ã«æº€è¶³ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "å°†æ¥ã®ç›®æ¨™ãŒã¯ã£ãã‚Šã—ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
            "å‹‰å¼·ã‚„èª²é¡Œã®ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "å…ˆç”Ÿã‚„æ•™æˆã‹ã‚‰ã®ã‚µãƒãƒ¼ãƒˆã‚’æ„Ÿã˜ã‚‰ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "ã‚¯ãƒ©ã‚¹ãƒ¡ãƒ¼ãƒˆã‚„åŒç´šç”Ÿã¨ã®é–¢ä¿‚ã¯è‰¯å¥½ã§ã™ã‹ï¼Ÿ",
            "è‡ªåˆ†ã®å°‚æ”»ã‚„åˆ†é‡ã«èˆˆå‘³ã‚’æŒã¡ç¶šã‘ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "èª²å¤–æ´»å‹•ã‚„ã‚µãƒ¼ã‚¯ãƒ«ã«å‚åŠ ã—ã¦æ¥½ã—ã‚“ã§ã„ã¾ã™ã‹ï¼Ÿ",
            "å­¦æ¥­ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã®ãƒãƒ©ãƒ³ã‚¹ã¯å–ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "å°±è·ã‚„é€²è·¯ã«ã¤ã„ã¦ä¸å®‰ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "å¤§å­¦ç”Ÿæ´»å…¨ä½“ã«æº€è¶³ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ"
        ]
    };

    // Japanese Reflection Questions (11-19)
    const reflectionQuestions = [
        "æœ€è¿‘ã€ã”è‡ªèº«ã®ä¸­ã§ä½•ã‹å¤‰åŒ–ã‚’æ„Ÿã˜ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
        "èª°ã«ã‚‚è©±ã—ã¦ã„ãªã„ã‘ã‚Œã©ã€å¿ƒã«å¼•ã£ã‹ã‹ã£ã¦ã„ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
        "ã€Œã“ã‚Œã§æœ¬å½“ã«å¤§ä¸ˆå¤«ã‹ãªï¼Ÿã€ã¨æ€ã†ç¬é–“ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
        "ä»Šã€æˆ‘æ…¢ã—ã¦ã„ã‚‹ã“ã¨ã‚„ç„¡ç†ã‚’ã—ã¦ã„ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
        "æœ€è¿‘æ°—ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ã€ã†ã¾ãè¨€è‘‰ã«ã§ããªã„ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
        "æœ€è¿‘ã€è‡ªåˆ†ã‚’è¤’ã‚ã¦ã‚ã’ãŸã„ã¨æ€ã£ãŸç¬é–“ã¯ã‚ã‚Šã¾ã—ãŸã‹ï¼Ÿ",
        "æœ¬å½“ã¯ã‚„ã‚ŠãŸã„ã®ã«ã€ã§ããšã«ã„ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
        "ã‚‚ã—ä¸€ã¤ã ã‘ã€å‘¨ã‚Šã®äººã«åˆ†ã‹ã£ã¦ã‚‚ã‚‰ã„ãŸã„ã“ã¨ãŒã‚ã‚‹ã¨ã—ãŸã‚‰ï¼Ÿ",
        "ä»Šã€èª°ã‹ã«ä¼ãˆãŸã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚‹ã¨ã—ãŸã‚‰ã€ã©ã‚“ãªã“ã¨ã§ã™ã‹ï¼Ÿ"
    ];

    // Heart Landscape Question (20)
    const heartQuestion = {
        title: "ã‚ãªãŸã®å¿ƒã®é¢¨æ™¯",
        subtitle: "ä»Šã®ã‚ãªãŸã®å¿ƒã‚’ã€é¢¨æ™¯ã‚„å ´é¢ã¨ã—ã¦è‡ªç”±ã«è¡¨ç¾ã—ã¦ã¿ã¦ãã ã•ã„ã€‚è‰²ã€éŸ³ã€é›°å›²æ°—ã€å¤©æ°—ã€äººã®å­˜åœ¨ãªã©ã€å¿ƒã«æµ®ã‹ã‚“ã ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’3ã€œ5è¡Œã§æã„ã¦ã¿ã¦ãã ã•ã„ã€‚",
        placeholder: "å¤•æš®ã‚Œã®é™ã‹ãªæ£®... æ³¢ãŒå„ªã—ãå²¸è¾ºã«å¯„ã›ã¦ã„ã‚‹... æš–ã‹ã„å…‰ã«åŒ…ã¾ã‚ŒãŸéƒ¨å±‹... é›¨ä¸ŠãŒã‚Šã®è™¹... ã©ã‚“ãªã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã‚‚å¤§ä¸ˆå¤«ã§ã™..."
    };

    // Global variables
    let currentQuestion = 0;
    let selectedDepartment = '';
    let userProfile = {};
    let answers = [];
    let currentQuestions = [];
    let sliderValue = 3;
    let isSliderActive = false;

    // Sparkle effect
    function createSparkles() {
        for (let i = 0; i < 15; i++) {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.style.left = Math.random() * 100 + '%';
            sparkle.style.top = Math.random() * 100 + '%';
            sparkle.style.animationDelay = Math.random() * 3 + 's';
            document.body.appendChild(sparkle);
        }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
        createSparkles();
        setupDepartmentSelection();
        setupStartButton();
        setupSlider();
    });

    function setupDepartmentSelection() {
        const deptCards = document.querySelectorAll('.dept-card');
        
        deptCards.forEach(card => {
            card.addEventListener('click', function() {
                deptCards.forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                selectedDepartment = this.dataset.department;
                checkStartButtonState();
            });
        });

        document.getElementById('userName').addEventListener('input', checkStartButtonState);
        document.getElementById('userAge').addEventListener('input', checkStartButtonState);
    }

    function checkStartButtonState() {
        const name = document.getElementById('userName').value.trim();
        const age = document.getElementById('userAge').value;
        const startButton = document.getElementById('startAssessment');
        
        if (name && age && selectedDepartment) {
            startButton.disabled = false;
        } else {
            startButton.disabled = true;
        }
    }

    function setupStartButton() {
        document.getElementById('startAssessment').addEventListener('click', function() {
            userProfile = {
                name: document.getElementById('userName').value.trim(),
                age: parseInt(document.getElementById('userAge').value),
                department: selectedDepartment
            };
            
            startAssessment();
        });
    }

    function setupSlider() {
        const track = document.getElementById('sliderTrack');
        const thumb = document.getElementById('sliderThumb');
        const valueDisplay = document.getElementById('sliderValue');

        function updateSlider(clientX) {
            const rect = track.getBoundingClientRect();
            const percentage = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
            const value = Math.round(percentage * 4) + 1; // 1-5 scale
            
            sliderValue = value;
            thumb.style.left = percentage * 100 + '%';
            valueDisplay.textContent = value;
            
            // Enable next button
            document.getElementById('nextButton').disabled = false;
            
            // Update thumb color based on value
            const colors = ['#dc2626', '#f59e0b', '#6b7280', '#10b981', '#059669'];
            thumb.style.borderColor = colors[value - 1];
        }

        // Mouse events
        track.addEventListener('click', (e) => updateSlider(e.clientX));
        
        thumb.addEventListener('mousedown', (e) => {
            isSliderActive = true;
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);
            e.preventDefault();
        });

        // Touch events for mobile
        track.addEventListener('touchstart', (e) => {
            updateSlider(e.touches[0].clientX);
        });

        thumb.addEventListener('touchstart', (e) => {
            isSliderActive = true;
            document.addEventListener('touchmove', handleTouchMove);
            document.addEventListener('touchend', handleTouchEnd);
            e.preventDefault();
        });

        function handleMouseMove(e) {
            if (isSliderActive) {
                updateSlider(e.clientX);
            }
        }

        function handleMouseUp() {
            isSliderActive = false;
            document.removeEventListener('mousemove', handleMouseMove);
            document.removeEventListener('mouseup', handleMouseUp);
        }

        function handleTouchMove(e) {
            if (isSliderActive) {
                updateSlider(e.touches[0].clientX);
            }
        }

        function handleTouchEnd() {
            isSliderActive = false;
            document.removeEventListener('touchmove', handleTouchMove);
            document.removeEventListener('touchend', handleTouchEnd);
        }
    }

    function buildQuestionsArray() {
        const deptQuestions = departmentQuestions[selectedDepartment];
        
        currentQuestions = [
            ...deptQuestions.map(q => ({ type: 'slider', question: q })),
            ...reflectionQuestions.map(q => ({ type: 'text', question: q })),
            {
                type: 'text',
                question: heartQuestion.title,
                subtitle: heartQuestion.subtitle,
                placeholder: heartQuestion.placeholder
            }
        ];
        
        answers = new Array(currentQuestions.length).fill('');
    }

    function startAssessment() {
        console.log('è¨ºæ–­é–‹å§‹...');
        buildQuestionsArray();
        console.log('è³ªå•é…åˆ—æ§‹ç¯‰å®Œäº†:', currentQuestions.length);
        
        // Hide welcome section with animation
        const welcomeSection = document.getElementById('welcomeSection');
        welcomeSection.style.transition = 'opacity 0.3s ease';
        welcomeSection.style.opacity = '0';
        
        setTimeout(() => {
            welcomeSection.style.display = 'none';
            
            // Show progress bar
            const progressSection = document.getElementById('progressSection');
            progressSection.style.display = 'block';
            
            // Show question section
            const questionSection = document.getElementById('questionSection');
            questionSection.style.display = 'block';
            questionSection.classList.add('active');
            
            console.log('è³ªå•ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤ºå®Œäº†');
            
            // Show first question after a moment
            setTimeout(() => {
                console.log('æœ€åˆã®è³ªå•ã‚’è¡¨ç¤º');
                showQuestion(0);
            }, 100);
            
        }, 300);
    }

    function showQuestion(questionIndex) {
        console.log('showQuestionå‘¼ã³å‡ºã—:', questionIndex);
        
        currentQuestion = questionIndex;
        const question = currentQuestions[questionIndex];
        
        console.log('ç¾åœ¨ã®è³ªå•:', question);
        
        // Ensure question section is visible
        const questionSection = document.getElementById('questionSection');
        questionSection.style.display = 'block';
        questionSection.style.opacity = '1';
        
        updateProgress();
        
        document.getElementById('questionStep').textContent = `è³ªå• ${questionIndex + 1} / ${currentQuestions.length}`;
        document.getElementById('questionTitle').textContent = question.question;
        document.getElementById('questionSubtitle').textContent = question.subtitle || '';
        
        console.log('è³ªå•ãƒ†ã‚­ã‚¹ãƒˆè¨­å®šå®Œäº†');
        
        const sliderContainer = document.getElementById('sliderContainer');
        const freeTextArea = document.getElementById('freeTextArea');
        
        // Clear previous state
        sliderContainer.style.display = 'none';
        freeTextArea.classList.add('hidden');
        
        if (question.type === 'slider') {
            console.log('ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼è³ªå•è¡¨ç¤º');
            sliderContainer.style.display = 'block';
            resetSlider();
        } else {
            console.log('ãƒ†ã‚­ã‚¹ãƒˆè³ªå•è¡¨ç¤º');
            freeTextArea.classList.remove('hidden');
            freeTextArea.placeholder = question.placeholder || 'ãŠæ°—æŒã¡ã‚’è‡ªç”±ã«ãŠèã‹ã›ãã ã•ã„...';
            freeTextArea.value = '';
            
            // Remove previous event listeners
            const newTextArea = freeTextArea.cloneNode(true);
            freeTextArea.parentNode.replaceChild(newTextArea, freeTextArea);
            
            // Add new event listener
            document.getElementById('freeTextArea').addEventListener('input', updateTextAnswer);
        }
        
        updateNavigationButtons();
        restorePreviousAnswer();
        
        console.log('è³ªå•è¡¨ç¤ºå®Œäº†');
    }

    function resetSlider() {
        sliderValue = 3;
        document.getElementById('sliderThumb').style.left = '50%';
        document.getElementById('sliderValue').textContent = '3';
        document.getElementById('sliderThumb').style.borderColor = '#6b7280';
        document.getElementById('nextButton').disabled = true;
    }

    function updateTextAnswer() {
        const textArea = document.getElementById('freeTextArea');
        answers[currentQuestion] = textArea.value.trim();
        
        const nextButton = document.getElementById('nextButton');
        nextButton.disabled = !textArea.value.trim();
    }

    function updateProgress() {
        const progress = ((currentQuestion + 1) / currentQuestions.length) * 100;
        document.getElementById('progressFill').style.width = progress + '%';
        document.getElementById('progressText').textContent = `è³ªå• ${currentQuestion + 1} / ${currentQuestions.length}`;
    }

    function updateNavigationButtons() {
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        
        prevButton.style.visibility = currentQuestion === 0 ? 'hidden' : 'visible';
        nextButton.textContent = currentQuestion === currentQuestions.length - 1 ? 'è¨ºæ–­ã‚’å®Œäº†ã™ã‚‹ â†’' : 'æ¬¡ã¸ â†’';
        nextButton.disabled = true;
    }

    function restorePreviousAnswer() {
        const answer = answers[currentQuestion];
        if (!answer) return;

        const question = currentQuestions[currentQuestion];
        
        if (question.type === 'slider') {
            const value = parseInt(answer);
            if (value >= 1 && value <= 5) {
                sliderValue = value;
                const percentage = (value - 1) / 4;
                document.getElementById('sliderThumb').style.left = percentage * 100 + '%';
                document.getElementById('sliderValue').textContent = value;
                
                const colors = ['#dc2626', '#f59e0b', '#6b7280', '#10b981', '#059669'];
                document.getElementById('sliderThumb').style.borderColor = colors[value - 1];
                document.getElementById('nextButton').disabled = false;
            }
        } else {
            document.getElementById('freeTextArea').value = answer;
            document.getElementById('nextButton').disabled = false;
        }
    }

    function nextQuestion() {
        // Store current answer
        const question = currentQuestions[currentQuestion];
        if (question.type === 'slider') {
            answers[currentQuestion] = sliderValue.toString();
        } else {
            answers[currentQuestion] = document.getElementById('freeTextArea').value.trim();
        }

        if (currentQuestion === currentQuestions.length - 1) {
            completeAssessment();
        } else {
            showQuestion(currentQuestion + 1);
        }
    }

    function previousQuestion() {
        if (currentQuestion > 0) {
            showQuestion(currentQuestion - 1);
        }
    }

    async function completeAssessment() {
        document.getElementById('loadingOverlay').style.display = 'flex';
        
        try {
            const assessmentData = {
                profile: userProfile,
                answers: answers,
                timestamp: new Date().toISOString(),
                department_questions: answers.slice(0, 10),
                quiet_responses: answers.slice(10, 19),
                heart_landscape: answers[19]
            };

            console.log('è¨ºæ–­å®Œäº†:', assessmentData);

            // ã‚»ãƒ‘ãƒ¬ãƒ¼ãƒˆå¼ï¼šè»½ã„çµæœè¡¨ç¤ºã®ãŸã‚å°‘ã—å¾…æ©Ÿ
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // è¨ºæ–­ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ™‚ä¿å­˜ï¼ˆã‚»ãƒ‘ãƒ¬ãƒ¼ãƒˆå¼ç”¨ï¼‰
            localStorage.setItem('latestAssessment', JSON.stringify(assessmentData));
            
            // ğŸ‰ ã‚»ãƒ‘ãƒ¬ãƒ¼ãƒˆå¼ï¼šè»½ã„çµæœãƒšãƒ¼ã‚¸ã¸è‡ªå‹•ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
            console.log('ã‚»ãƒ‘ãƒ¬ãƒ¼ãƒˆå¼ï¼šè»½ã„çµæœãƒšãƒ¼ã‚¸ã¸ç§»å‹•');
            window.location.href = 'https://m404o.github.io/d_result/dlight_result.html';
            
        } catch (error) {
            console.error('è¨ºæ–­ã‚¨ãƒ©ãƒ¼:', error);
            
            // ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ­ãƒ¼ã‚«ãƒ«å®Œäº†ç”»é¢è¡¨ç¤º
            document.getElementById('loadingOverlay').style.display = 'none';
            showLocalCompletionMessage();
        }
    }

    function showLocalCompletionMessage() {
        document.getElementById('questionSection').style.display = 'none';
        document.getElementById('progressSection').style.display = 'none';
        
        const container = document.querySelector('.container');
        const completionHTML = `
            <div class="glass-card">
                <div class="step-badge">è¨ºæ–­å®Œäº†</div>
                <h2 class="title">${userProfile.name}ã•ã‚“ã€ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼</h2>
                <p class="subtitle">å¿ƒç†ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚ã‚»ãƒ‘ãƒ¬ãƒ¼ãƒˆå¼ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚Šã€è»½ã‚„ã‹ãªçµæœã‚’ãŠå±Šã‘ã—ã¾ã™ã€‚</p>
                
                <div style="text-align: center; margin: 3rem 0; padding: 2rem; background: rgba(255, 255, 255, 0.4); border-radius: 20px; backdrop-filter: blur(10px);">
                    <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ¨</div>
                    <h3 style="color: #374151; margin-bottom: 1rem;">ã‚»ãƒ‘ãƒ¬ãƒ¼ãƒˆå¼è¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ </h3>
                    <p style="color: #6b7280; line-height: 1.6;">
                        ã‚ãªãŸã®å›ç­”ã¯å®‰å…¨ã«å‡¦ç†ã•ã‚Œã€<br>
                        è»½ã‚„ã‹ãªçµæœç”»é¢ã§ãŠè¦‹ã›ã—ã¾ã™ã€‚
                    </p>
                </div>
                
                <div class="nav-buttons">
                    <button class="glass-button btn-next" onclick="viewLightResults()">
                        ğŸŒ¸ è»½ã„çµæœã‚’è¦‹ã‚‹
                    </button>
                    <button class="glass-button btn-back" onclick="location.reload()">
                        ğŸ”„ æ–°ã—ã„è¨ºæ–­
                    </button>
                </div>
            </div>
        `;
        
        container.innerHTML = completionHTML;
    }

    function viewLightResults() {
        console.log('ğŸ‰ ã‚»ãƒ‘ãƒ¬ãƒ¼ãƒˆå¼ï¼šè»½ã„çµæœãƒšãƒ¼ã‚¸ã¸ç§»å‹•');
        window.location.href = 'https://m404o.github.io/d_result/dlight_result.html';
    }
</script>
```

</body>
</html>
